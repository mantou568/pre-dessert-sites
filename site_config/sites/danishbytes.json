{
  "id": "danishbytes",
  "name": "DBy",
  "domain": "https://danishbytes.club",
  "encoding": "UTF-8",
  "public": false,
  "schema": "NexusPHP",
  "required": {
    "cookie": true,
    "sign_in": false
  },
  "meta": {
    "has_free": true,
    "has_2x_free": true,
    "has_hr": false,
    "has_cover": true
  },
  "category": {
    "movie": [
      { "id": 1, "cat": "Movies", "desc": "Movies" }
    ],
    "tv": [
      { "id": 2, "cat": "TV", "desc": "TV Show" }
    ],
    "other": [
      { "id": 5, "cat": "Apps", "desc": "Apps" },
      { "id": 3, "cat": "Music", "desc": "Music" },
      { "id": 8, "cat": "Books", "desc": "Books" },
      { "id": 17, "cat": "AudioBooks", "desc": "AudioBooks" },
      { "id": 19, "cat": "Podcasts", "desc": "Podcasts" }
    ]
  },
  "requests": {
    "user_basic_info": {
      "parser": "XPath",
      "method": "GET",
      "path": "/",
      "fields": {
        "is_login": {
          "any": [
            {
              "selector": "//a[contains(@href,'/logout')]",
              "filters": [
                { "name": "re_search", "args": ["(注销|Logout|Log ud)", 0] },
                { "name": "replace", "args": ["注销", "true"] },
                { "name": "replace", "args": ["Logout", "true"] },
                { "name": "replace", "args": ["Log ud", "true"] }
              ]
            },
            {
              "selector": "//span[@id='userbar_getUploaded']",
              "filters": [{ "name": "not_blank" }]
            },
            {
              "selector": "//a[contains(@href,'/users/') and contains(@class,'badge-user')]",
              "filters": [{ "name": "not_blank" }]
            },
            {
              "selector": "//form[contains(@action,'logout')]",
              "filters": [{ "name": "not_blank" }]
            }
          ]
        },
        "id": {
          "any": [
            {
              "selector": "//a[contains(@href,'/users/') and contains(@class,'badge-user')]/@href",
              "filters": [{ "name": "re_search", "args": ["/users/([^/]+)", 1] }]
            },
            {
              "selector": "//a[contains(@href,'/users/')]/@href",
              "filters": [{ "name": "re_search", "args": ["/users/([^/]+)", 1] }]
            }
          ]
        },
        "name": {
          "any": [
            {
              "selector": "//a[contains(@href,'/users/')]//span[@class='badge-user']//strong[1]/text()",
              "filters": [{ "name": "strip" }]
            },
            {
              "selector": "//a[contains(@href,'/users/')]//strong/text()",
              "filters": [{ "name": "strip" }]
            }
          ]
        },
        "uploaded": {
          "selector": "//span[@id='userbar_getUploaded']/text()",
          "filters": [
            { "name": "strip" },
            { "name": "byte_size" }
          ]
        },
        "downloaded": {
          "selector": "//span[@id='userbar_getDownloaded']/text()",
          "filters": [
            { "name": "strip" },
            { "name": "byte_size" }
          ]
        },
        "ratio": {
          "selector": "//span[@id='userbar_getRatioString']/text()",
          "filters": [
            { "name": "strip" },
            { "name": "replace", "args": ["∞", "0"] },
            { "name": "replace", "args": ["Inf", "0"] }
          ]
        },
        "bonus": {
          "selector": "//span[@id='userbar_getSeedbonus']/text()",
          "filters": [
            { "name": "strip" },
            { "name": "replace", "args": [" ", ""] },
            { "name": "replace", "args": [",", ""] }
          ]
        }
      }
    },
    "user_details": {
      "parser": "XPath",
      "method": "GET",
      "path": "/users/{userId}",
      "fields": {
        "level": {
          "any": [
            {
              "selector": "//span[@id='userbar_group']//strong/text()",
              "filters": [{ "name": "strip" }]
            },
            {
              "selector": "//span[contains(@class,'badge-user')]//strong/text()",
              "filters": [{ "name": "strip" }]
            },
            {
              "selector": "//h4[contains(.,'Group')]//span[contains(@class,'badge-user')]//strong/text()",
              "filters": [{ "name": "strip" }]
            },
            {
              "selector": "//a[contains(@class,'user-tag__link')]/@title",
              "filters": [{ "name": "strip" }]
            }
          ]
        },
        "join_at": {
          "any": [
            {
              "selector": "//h4[contains(.,'Registration date')]",
              "filters": [
                { "name": "re_search", "args": ["Registration date\\s+([A-Za-z]{3}\\s+\\d{1,2}\\s+\\d{4})", 1] },
                { "name": "timestamp", "args": ["Jan 2 2006"] },
                { "name": "timezone", "args": ["+7"] }
              ]
            },
            {
              "selector": "//h4[contains(.,'Registration date')]//text()[normalize-space()]",
              "filters": [
                { "name": "re_search", "args": ["Registration date\\s+([A-Za-z]{3}\\s+\\d{1,2}\\s+\\d{4})", 1] },
                { "name": "timestamp", "args": ["Jan 2 2006"] },
                { "name": "timezone", "args": ["+7"] }
              ]
            }
          ]
        },
        "last_accessed": {
          "any": [
            {
              "selector": "//td[contains(normalize-space(),'Last Login')]/following-sibling::td[1]",
              "filters": [
                { "name": "re_search", "args": ["([A-Za-z]{3},\\s+[A-Za-z]{3}\\s+\\d{1,2},\\s+\\d{4}\\s+\\d{1,2}:\\d{2}\\s+[AP]M)", 1] },
                { "name": "timestamp", "args": ["Mon, Jan 2, 2006 3:04 PM"] },
                { "name": "timezone", "args": ["+7"] }
              ]
            },
            {
              "selector": "//dt[contains(text(),'Last') or contains(text(),'Sidst') or contains(text(),'last')]/following-sibling::dd[1]/time/@datetime",
              "filters": [
                { "name": "timestamp" },
                { "name": "timezone", "args": ["+7"] }
              ]
            }
          ]
        }
      }
    },
    "seeding_statistics": {
      "parser": "XPath",
      "method": "GET",
      "path": "/users/{userId}",
      "disabled_extends": { "list": true },
      "fields": {
        "count": {
          "any": [
            {
              "selector": "//span[contains(text(),'Total Seeding')]/following-sibling::span[contains(@class,'text-green') and contains(@class,'text-bold')]",
              "filters": [
                { "name": "strip" }
              ]
            },
            {
              "selector": "//span[@id='userbar_getSeeding']/text()",
              "filters": [
                { "name": "strip" }
              ]
            }
          ]
        },
        "size": {
          "any": [
            {
              "selector": "//td[contains(text(),'Seeding Size')]/following-sibling::td[1]//span[contains(@class,'badge-user')]",
              "filters": [
                { "name": "strip" },
                { "name": "replace", "args": ["\u00a0", " "] },
                { "name": "byte_size" }
              ]
            },
            {
              "selector": "//table[contains(@class,'table-striped')]//tbody//tr[.//a[contains(@class,'view-torrent')]]//td[3]//span[contains(@class,'badge-extra')]",
              "filters": [
                { "name": "strip" },
                { "name": "replace", "args": ["\u00a0", " "] },
                { "name": "byte_size" }
              ],
              "array": true
            }
          ]
        }
      }
    },
    "messages": {
      "parser": "XPath",
      "method": "GET",
      "path": "/users/{userId}/conversations",
      "list": { "selector": "//table[contains(@class, 'data-table')]/tbody/tr" },
      "fields": {
        "title": { "selector": "./td[2]/a", "filters": [{ "name": "strip" }] },
        "link": { "selector": "./td[2]/a/@href" },
        "id": {
          "selector": "./td[2]/a/@href",
          "filters": [{ "name": "re_search", "args": ["/conversations/(\\d+)", 1] }]
        },
        "sender": {
          "selector": "./td[1]//span[contains(@class, 'user-tag')]/a",
          "filters": [{ "name": "strip" }]
        },
        "date": {
          "selector": "./td[3]/time/@title",
          "filters": [{ "name": "strip" }]
        },
        "unread": {
          "selector": "./td[5]/i[not(contains(@class, 'text-green'))]",
          "filters": [{ "name": "not_blank" }]
        }
      }
    },
    "notice": {
      "parser": "XPath",
      "method": "GET",
      "path": "/articles",
      "fields": {
        "content": {
          "selector": "//article[contains(@class, 'article-preview')]"
        }
      }
    },
    "message_detail": {
      "parser": "XPath",
      "method": "GET",
      "path": "/mail/{id}",
      "fields": {
        "content": {
          "selector": "//div[contains(@class,'message-body')]//div[contains(@class,'col-sm-12')]",
          "filters": [{ "name": "strip" }]
        }
      }
    },
    "search": {
      "path": "torrents",
      "params": {
        "search": ["{keyword}"],
        "search_not": [""],
        "imdb": [""],
        "on_fire": ["0"],
        "on_green": ["0"],
        "freeleech": ["0"],
        "doubleupload": ["0"],
        "page": ["1"],
        "qty": ["25"]
      },
      "list": {
        "selector": "table.table tbody#torrents_results tr, table.data-table tbody tr, table.table tbody tr"
      },
      "fields": {
        "id": {
          "selector": "a.torrent-search--list__name, a[href*='/torrents/'][href*='?id='], a[href*='/torrents/'][href*='/']:not([href*='/download/'])",
          "attribute": "href",
          "filters": [
            { "name": "re_search", "args": ["/torrents/(\\d+)", 1] }
          ]
        },
        "title": {
          "selector": "a.torrent-search--list__name, a[href*='/torrents/'][href*='?id='], a[href*='/torrents/']:not([href*='/download/'])"
        },
        "details": {
          "selector": "a.torrent-search--list__name, a[href*='/torrents/'][href*='?id='], a[href*='/torrents/']:not([href*='/download/'])",
          "attribute": "href"
        },
        "download": {
          "selector": "a[href*='/torrents/download/'], a[href*='/download/']",
          "attribute": "href"
        },
        "date_added": {
          "selector": "td.torrent-search--list__age time, td[class*='age'] time",
          "attribute": "datetime",
          "filters": [
            { "name": "strip" },
            { "name": "timestamp", "args": ["2006-01-02 15:04:05"] },
            { "name": "timezone", "args": ["+7"] }
          ]
        },
        "size": {
          "selector": "td.torrent-search--list__size span, td.torrent-search--list__size, td[class*='size'] span, td[class*='size']",
          "filters": [
            { "name": "strip" },
            { "name": "byte_size" }
          ]
        },
        "seeders": {
          "selector": "a.torrent__seeder-count, a[href*='seeders']"
        },
        "leechers": {
          "selector": "a.torrent__leecher-count, a[href*='leechers']"
        },
        "grabs": {
          "selector": "a.torrent__times-completed-count, a[href*='times_completed'], a[href*='times-completed']"
        },
        "downloadvolumefactor": {
          "case": {
            "i.torrent-icons__freeleech, i.fa-star.text-gold": 0,
            "*": 1
          }
        },
        "uploadvolumefactor": {
          "case": {
            "i.fa-gem.text-green": 2,
            "*": 1
          }
        }
      }
    }
  }
}
