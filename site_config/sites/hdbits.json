{
  "id": "hdbits",
  "name": "HDB",
  "domain": "https://hdbits.org",
  "additional_domain": [],
  "public": false,
  "schema": "NexusPHP",
  "required": {
    "cookie": true,
    "sign_in": false
  },
  "meta": {
    "has_free": true,
    "has_2x_free": true,
    "has_hr": false,
    "has_cover": true
  },
  "category": {
    "movie": [{ "id": 1, "cat": "Movies", "desc": "Movies" }],
    "tv": [{ "id": 2, "cat": "TV", "desc": "TV Series" }]
  },
  "requests": {
    "favicon": {
      "parser": "None",
      "method": "GET",
      "path": "/favicon.ico"
    },
    "user_basic_info": {
      "parser": "XPath",
      "method": "GET",
      "path": "/",
      "fields": {
        "is_login": {
          "selector": "//a[contains(@href, 'logout') or contains(@href, 'logoff')]",
          "filters": [{ "name": "not_blank" }]
        },
        "id": {
          "selector": "//a[contains(@href, 'userdetails.php') or contains(@href, 'user.php')]/@href",
          "filters": [{ "name": "re_search", "args": ["[?&]id=(\\d+)", 1] }]
        },
        "name": {
          "selector": "//a[contains(@href, 'userdetails.php') or contains(@href, 'user.php')]/text()",
          "filters": [{ "name": "strip" }]
        },
        "uploaded": {
          "selector": "//font[contains(text(), 'UL:')]/following-sibling::text()[1]",
          "filters": [{ "name": "strip" }, { "name": "byte_size" }]
        },
        "downloaded": {
          "selector": "//font[contains(text(), 'DL:')]/following-sibling::text()[1]",
          "filters": [{ "name": "strip" }, { "name": "byte_size" }]
        },
        "ratio": {
          "selector": "//font[contains(text(), 'Ratio:')]/following-sibling::font[1]",
          "filters": [{ "name": "strip" }]
        },
        "bonus": {
          "selector": "//a[contains(@href, '/bonus')]/text()",
          "filters": [{ "name": "replace", "args": [",", ""] }, { "name": "strip" }]
        }
      }
    },
    "user_details": {
      "parser": "XPath",
      "method": "GET",
      "path": "/userdetails.php",
      "params": {
        "id": ["{userId}"]
      },
      "fields": {
        "level": {
          "selector": "//td[contains(text(), 'Class') or contains(text(), '等级')]/following-sibling::td[1]",
          "filters": [{ "name": "strip" }]
        },
        "join_at": {
          "selector": "//td[@class='rowhead' and contains(text(), 'JOIN')]/following-sibling::td[1]",
          "filters": [
            { "name": "strip" },
            { "name": "re_search", "args": ["(\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2})", 1] },
            { "name": "timestamp", "args": ["2006-01-02 15:04:05"] }
          ]
        },
        "last_accessed": {
          "selector": "//td[@class='rowhead' and contains(text(), 'Last')]/following-sibling::td[1]",
          "filters": [
            { "name": "strip" },
            { "name": "re_search", "args": ["(\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2})", 1] },
            { "name": "timestamp", "args": ["2006-01-02 15:04:05"] },
            { "name": "timezone", "args": ["+8"] }
          ]
        }
      }
    },
    "seeding_statistics": {
      "parser": "XPath",
      "method": "GET",
      "path": "/userdetails.php",
      "params": {
        "id": ["{userId}"]
      },
      "disabled_extends": { "list": true },
      "fields": {
        "count": {
          "selector": "//td[@class='heading' and contains(text(), 'Currently') and contains(text(), 'seeding')]/following-sibling::td[1]/text()[last()]",
          "filters": [
            { "name": "strip" },
            { "name": "replace", "args": ["&nbsp;", " "] },
            { "name": "replace", "args": ["\\s+", " "] },
            { "name": "re_search", "args": ["(\\d+)", 1] }
          ]
        },
        "size": {
          "selector": "//td[@class='rowhead' and contains(text(), 'Seeding size') and .//abbr[contains(text(), 'special')]]/following-sibling::td[1]",
          "filters": [
            { "name": "strip" },
            { "name": "re_search", "args": ["([\\d.]+\\s+[KMGTPE]?i?B)", 1] },
            { "name": "byte_size" }
          ]
        }
      }
    },
    "notice": {
      "parser": "XPath",
      "method": "GET",
      "path": "/",
      "list": {
        "selector": "//div[@id='news']//h1"
      },
      "fields": {
        "id": {
          "selector": "./following-sibling::p[1]/@id",
          "filters": [
            { "name": "re_search", "args": ["news(\\d+)", 1] }
          ]
        },
        "title": {
          "selector": "./text()",
          "filters": [
            { "name": "re_search", "args": ["^(.+?)\\s*-\\s*\\d{4}-\\d{2}-\\d{2}$", 1] },
            { "name": "strip" }
          ]
        },
        "date": {
          "selector": "./text()",
          "filters": [
            { "name": "re_search", "args": ["(\\d{4}-\\d{2}-\\d{2})", 1] },
            { "name": "timestamp", "args": ["2006-01-02"] },
            { "name": "timezone", "args": ["+8"] }
          ]
        },
        "content": {
          "selector": "./following-sibling::p[1]",
          "filters": [
            { "name": "strip" }
          ]
        }
      }
    },
    "search": {
      "parser": "CssSelector",
      "method": "GET",
      "path": "/browse.php",
      "params": {
        "search": ["{keyword}"],
        "page": ["{page}"]
      },
      "list": {
        "selector": "table#torrent-list > tbody > tr[id^='t']"
      },
      "fields": {
        "id": {
          "selector": "a[href*='details.php?id=']",
          "attribute": "href",
          "filters": [{ "name": "re_search", "args": ["id=(\\d+)", 1] }]
        },
        "cover": {
          "selector": "div.browse_imdb_poster > img",
          "attribute": "src"
        },
        "title": {
          "selector": "td.browse_td_name_cell > b > a, td:not(.browse_td_name_cell) > b > a[href*='details.php?id=']",
          "filters": [{ "name": "strip" }]
        },
        "details": {
          "selector": "a[href*='details.php?id=']",
          "attribute": "href",
          "filters": [{ "name": "re_search", "args": ["(details\\.php\\?id=\\d+)", 1] }]
        },
        "imdb": {
          "any": [
            {
              "selector": "a[data-imdb-link]",
              "attribute": "data-imdb-link"
            },
            {
              "selector": "a[href*='/film/info']",
              "attribute": "href",
              "filters": [
                { "name": "re_search", "args": ["/film/info\\?id=(\\d+)", 1] },
                { "name": "pad_zero", "args": 7 },
                { "name": "append_left", "args": "https://www.imdb.com/title/tt" },
                { "name": "append_right", "args": "/" }
              ]
            }
          ]
        },
        "download": {
          "selector": "a.js-download",
          "attribute": "href"
        },
        "size": {
          "selector": "td:nth-child(6)",
          "filters": [
            { "name": "replace", "args": ["<br>", " "] },
            { "name": "replace", "args": ["<br />", " "] },
            { "name": "strip" },
            { "name": "byte_size" }
          ]
        },
        "seeders": {
          "selector": "td.right > b > a[href*='toseeders=1'] > font, td.right > b > a[href*='toseeders=1']",
          "filters": [{ "name": "strip" }]
        },
        "leechers": {
          "selector": "td.right > b > a[href*='todlers=1']",
          "filters": [{ "name": "strip" }]
        },
        "grabs": {
          "selector": "td.center > a[href*='#snatches']",
          "filters": [{ "name": "strip" }]
        },
        "date_added": {
          "selector": "td.center > span[title]",
          "attribute": "title",
          "filters": [
            { "name": "strip" },
            { "name": "timestamp", "args": ["2006-01-02 15:04:05"] },
            { "name": "timezone", "args": ["+8"] }
          ]
        },
        "downloadvolumefactor": {
          "case": {
            "a[title*='100% FL']": 0,
            "a[title*='50% Free Leech']": 0.5,
            "*": 1
          }
        },
        "uploadvolumefactor": {
          "case": {
            "a[title*='100% FL']": 0.5,
            "*": 1
          }
        }
      }
    }
  }
}
